import{l as t,f as m,r as x,c as h,d as b,e as I,h as c,v as w,w as B,k as D,g as F,j as N}from"./assets/helpers-DDQDsabU.js";import{i as p}from"./assets/vendor-Br9p5nBn.js";const E=()=>{const e=F();t.navCount&&(t.navCount.textContent=e.length)},u=()=>{const o=c().reduce((r,a)=>r+a.quantity,0);t.navCountCart&&(t.navCountCart.textContent=o)},v=e=>{if(!t.cartButton)return;const o=Number(e);h(o)?t.cartButton.textContent="Remove from Cart":t.cartButton.textContent="Add to Cart"},d=async()=>{const e=c();if(e.length===0){t.cartCount&&(t.cartCount.textContent="0"),t.cartPrice&&(t.cartPrice.textContent="$0.00");return}const o=e.filter(r=>typeof r.id<"u");if(o.length===0){t.cartCount&&(t.cartCount.textContent="0"),t.cartPrice&&(t.cartPrice.textContent="$0.00");return}try{const r=await Promise.all(o.map(n=>m(n.id))),a=o.reduce((n,i)=>n+i.quantity,0);t.cartCount&&(t.cartCount.textContent=a);const s=r.reduce((n,i)=>{const P=o.filter(f=>Number(f.id)===Number(i.id)).reduce((f,q)=>f+q.quantity,0);return n+i.price*P},0);t.cartPrice&&(t.cartPrice.textContent=`$${s.toFixed(2)}`)}catch(r){console.error("Помилка при оновленні підсумку кошика:",r),t.cartCount&&(t.cartCount.textContent="0"),t.cartPrice&&(t.cartPrice.textContent="$0.00")}},l=async()=>{const e=c();if(e.length===0){t.notFoundDiv&&t.notFoundDiv.classList.add("not-found--visible"),t.productsList.innerHTML="";return}const o=e.filter(r=>typeof r.id<"u");if(o.length===0){t.notFoundDiv&&t.notFoundDiv.classList.add("not-found--visible"),t.productsList.innerHTML="";return}try{const a=(await Promise.all(o.map(n=>m(n.id)))).map(n=>{const i=o.find(C=>Number(C.id)===Number(n.id));return{...n,quantity:i?i.quantity:1}});t.notFoundDiv&&t.notFoundDiv.classList.remove("not-found--visible"),N(a),document.querySelectorAll(".product-quantity").forEach(n=>n.classList.remove("hidden"))}catch(r){console.error("Помилка при завантаженні продуктів кошика:",r),t.notFoundDiv&&t.notFoundDiv.classList.add("not-found--visible"),t.productsList.innerHTML=""}};var y;(y=t.productsList)==null||y.addEventListener("click",async e=>{const o=e.target;if(o.classList.contains("quantity-button"))return;const r=o.closest("li.products__item");if(!r)return;const a=Number(r.dataset.id);if(a)try{const s=await m(a);x(s),t.modal&&t.modal.classList.add("modal--is-open"),v(a),t.cartButton&&(t.cartButton.onclick=async()=>{const n=Number(a);h(n)?b(n):I(n,1),v(n),u(),await l(),await d()})}catch(s){console.error("Помилка при завантаженні продукту:",s)}});var L;(L=t.cartSummaryButton)==null||L.addEventListener("click",async()=>{if(c().length===0){p.warning({title:"Oops!",message:"Your cart is empty!",position:"topLeft"});return}p.success({title:"Success!",message:"Products purchased successfully!",position:"topLeft"}),w(),await l(),u(),await d()});var g;(g=t.modal)==null||g.addEventListener("click",e=>{(e.target===t.modal||e.target.classList.contains("modal__close-btn"))&&t.modal.classList.remove("modal--is-open")});document.addEventListener("click",async e=>{const o=e.target.closest(".plus-button"),r=e.target.closest(".minus-button");if(o||r){const a=e.target.closest(".product");if(!a)return;const s=Number(a.dataset.id);if(!s)return;const n=a.querySelector(".quantity-input");if(!n)return;let i=parseInt(n.value,10)||0;o?i+=1:r&&i>0&&(i-=1),n.value=i,i>0?B(s,i):(b(s),await l()),await d(),u()}});document.addEventListener("DOMContentLoaded",()=>{D(),l(),u(),E(),d()});
//# sourceMappingURL=cart.js.map
