import{f as v,r as L,i as u,a as h,b,c as C,d as q,e as P,g as y,h as S,j as _,k as W}from"./assets/helpers-DDQDsabU.js";import"./assets/vendor-Br9p5nBn.js";const c=()=>{const o=y(),t=document.querySelector("[data-wishlist-count]");t&&(t.textContent=o.length),console.log("Wishlist count updated:",o.length)},a=()=>{const t=S().reduce((i,n)=>i+(n.quantity||1),0),s=document.querySelector("[data-cart-count]");s&&(s.textContent=t),console.log("Cart count updated:",t)},p=o=>{const t=document.querySelector(".modal-product__btn--wishlist");if(!t)return;const s=Number(o);u(s)?t.textContent="Remove from Wishlist":t.textContent="Add to Wishlist"},w=o=>{const t=document.querySelector(".modal-product__btn--cart");if(!t)return;const s=Number(o);C(s)?t.textContent="Remove from Cart":t.textContent="Add to Cart"},d=async()=>{const o=document.querySelector("ul.products"),t=document.querySelector(".not-found"),s=y();if(console.log("Loading wishlist products:",s),s.length===0){t&&t.classList.add("not-found--visible"),o&&(o.innerHTML="");return}try{const i=s.map(r=>v(r)),n=await Promise.all(i);console.log("Products loaded:",n),t&&t.classList.remove("not-found--visible"),_(n)}catch(i){console.error("Помилка при завантаженні wishlist:",i),t&&t.classList.add("not-found--visible"),o&&(o.innerHTML="")}};document.addEventListener("click",async o=>{const t=document.querySelector("ul.products"),s=o.target.closest("li.products__item");if(s&&t&&t.contains(s)){const n=Number(s.dataset.id);if(!n)return;try{const r=await v(n);L(r);const m=document.querySelector(".modal");m&&m.classList.add("modal--is-open"),p(n),w(n),setTimeout(()=>{const g=document.querySelector(".modal-product__btn--wishlist");g&&(g.onclick=l=>{l.stopPropagation();const e=Number(n);u(e)?(h(e),console.log("Removed from wishlist:",e)):(b(e),console.log("Added to wishlist:",e)),p(e),c(),d()});const f=document.querySelector(".modal-product__btn--cart");f&&(f.onclick=l=>{l.stopPropagation();const e=Number(n);C(e)?(q(e),console.log("Removed from cart:",e)):(P(e,1),console.log("Added to cart:",e),u(e)&&(h(e),c(),d())),w(e),a()})},0)}catch(r){console.error("Помилка при завантаженні продукту:",r)}}const i=document.querySelector(".modal");i&&(o.target===i||o.target.classList.contains("modal__close-btn"))&&i.classList.remove("modal--is-open")});window.addEventListener("storage",o=>{o.key==="wishlist"&&(console.log("Storage changed, reloading wishlist"),d(),c()),o.key==="cart"&&a()});window.addEventListener("wishlistUpdated",()=>{console.log("Wishlist updated event received"),d(),c()});window.addEventListener("cartUpdated",()=>{console.log("Cart updated event received"),a()});const B=()=>{console.log("Initializing wishlist page..."),W(),d(),c(),a(),console.log("Page initialized")};document.addEventListener("DOMContentLoaded",()=>{B()});window.addEventListener("focus",()=>{console.log("Page focused, reloading wishlist"),d(),c(),a()});
//# sourceMappingURL=wishlist.js.map
